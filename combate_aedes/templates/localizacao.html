<form hx-post="{{ request.path }}" class="modal-content">
    <style>
        .errorlist {color: red; font-weight: bold; list-style-type: none; padding-left: 0; margin-bottom: 4px;}
    </style>
    {% csrf_token %}
    <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Registrar um local</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
    </div>
    <div class="modal-body d-flex p-0" style="min-height: 340px">
        <div class="d-flex flex-grow-1 w-100" id="mapa"></div>
    </div>
    <div class="modal-footer">
        {% if voltar %}
        <button type="button" class="btn rounded-pill btn-secondary" hx-get="{% url voltar %}" hx-target="#dialog">Voltar</button>
        {% else %}
        <button type="button" class="btn rounded-pill btn-secondary" data-bs-dismiss="modal">Cancelar</button>
        {% endif %}
        <button type="submit" class="btn rounded-pill btn-primary">Continuar</button>
    </div>
</form>
<script>
    (g=>{var h,a,k,p="The Google Maps JavaScript API",c="google",l="importLibrary",q="__ib__",m=document,b=window;b=b[c]||(b[c]={});var d=b.maps||(b.maps={}),r=new Set,e=new URLSearchParams,u=()=>h||(h=new Promise(async(f,n)=>{await (a=m.createElement("script"));e.set("libraries",[...r]+"");for(k in g)e.set(k.replace(/[A-Z]/g,t=>"_"+t[0].toLowerCase()),g[k]);e.set("callback",c+".maps."+q);a.src=`https://maps.${c}apis.com/maps/api/js?`+e;d[q]=f;a.onerror=()=>h=n(Error(p+" could not load."));a.nonce=m.querySelector("script[nonce]")?.nonce||"";m.head.append(a)}));d[l]?console.warn(p+" only loads once. Ignoring:",g):d[l]=(f,...n)=>r.add(f)&&u().then(()=>d[l](f,...n))})({
      key: '{{ google_api_key }}',
      v: "weekly",
    });
</script>
<script>
    async function iniciarMapa() {
        const {Map} = await google.maps.importLibrary("maps");
        let latitude = parseFloat('{{ latitude }}');
        let longitude = parseFloat('{{ longitude }}');
        let centro = {lat: latitude, lng: longitude};
        let mapa = new Map(document.getElementById("mapa"), {zoom: 18, center: centro});
        const marker = new google.maps.Marker({
            position: { lat: latitude, lng: longitude },
            map: mapa,
        });
    }
    iniciarMapa();
</script>